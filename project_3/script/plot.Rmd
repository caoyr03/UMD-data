---
title: "Rplot"
author: "Yuru Cao"
date: "11/18/2019"
output: html_document
---
First, we read in the dataset from wrangled by Python, so it would be read into 21 columns and 5299 rows. 
```{r setup, include=FALSE}
library(ggplot2)
library(tidyverse)
data <- read_csv('/Users/caoyuru/Desktop/BIOS 611/project/bios611-projects-fall-2019-caoyr03/project_3/data/wrangle_data.csv') %>%
  select(-1)
```
<br/>
## Problem 1 The demographics of one-time short-term clients vs loyal/frequent clients?
<br/>
```{r, warning=FALSE}
# Wrangle the dataset group by Client while keeping other columns
client <- data %>%
  select(ClientID, Entrydate, Exitdate, Age_entry, Gender, Race, Ethnicity, Veteran) %>%
  mutate(Duration = as.Date(Exitdate,format="%m/%d/%Y") - as.Date(Entrydate,format="%m/%d/%Y")) %>%
  na.omit() %>%
  group_by(ClientID,Age_entry,Gender,Race,Ethnicity,Veteran) %>%
  summarize(Duration = sum(Duration))
# 1.age distribution with duration
age <- client %>%
  select(Duration,Age_entry,ClientID) %>%
  group_by(Duration) %>%
  summarize(age = mean(Age_entry))
# plot
ggplot(age, aes(x=Duration,y=age)) +
  geom_point()
# 2.race distribution with duration
race <- client %>%
  select(Duration, Race) %>%
  group_by(Duration,Race) %>%
  summarise(count = n())
# plot
ggplot(race, aes(x = Duration, fill=Race))+
  geom_bar(position = "fill")
# 3. gender distribution with duration
gender <- client %>%
  select(Duration, Gender) %>%
  group_by(Duration,Gender) %>%
  summarise(count=n())
# plot
ggplot(gender, aes(x = Duration, fill = Gender)) +
  geom_bar(position = "fill")
# 4. ethnicity distribution with duration
ethnicity <- client %>%
  select(Duration, Ethnicity) %>%
  group_by(Duration, Ethnicity) %>%
  summarise(count=n())
# plot
ggplot(ethnicity, aes(x = Duration, fill = Ethnicity)) + 
  geom_bar(position = "fill")
```
<br/>
## Problem 2 What are the time series patterns for those who receive help from UMD to exit program?
<br/>
```{r}
exit <- data %>%
  select(Exitdate, ClientID) %>%
  group_by(Exitdate) %>%
  summarise(count=n())
exit$Exitdate <- as.Date(exit$Exitdate,format="%m/%d/%Y")
ggplot(exit, aes(x=Exitdate,y=count)) + 
  geom_point()
```
<br/>
## Problem 3 The health/living conditions of clients
<br/>
```{r, warning=True}
count <- data %>% 
  select(Disability, HealthInsurance, ViolanceVictim) %>%
  gather(Category, Count) %>%
  table()
count
```
<br/>
## Problem 4 Prior living conditions vs Destination after they exit
<br/>
```{r}

```

